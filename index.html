<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Sentence completion</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="./css/styles.css">
        <style></style>
    </head>

<body>
    <div id="container1">
        <images></images>
    </div>    
</body>

<script type="module">
    import {createApp} from '/js/vue.esm-browser.js'
    const app = createApp({})

    const images = {
        data() {
            return {
                dataImages:[
                    {
                        url: 'https://images.pexels.com/photos/7195269/pexels-photo-7195269.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2',
                        word: 'naranja',
                    },
                    {
                        url: 'https://images.pexels.com/photos/102104/pexels-photo-102104.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2',
                        word: 'manzana',
                    },
                    {
                        url: 'https://images.pexels.com/photos/2872767/pexels-photo-2872767.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2',
                        word: 'banano',
                    },
                    {
                        url: 'https://images.pexels.com/photos/4033025/pexels-photo-4033025.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2',
                        word: 'mandarina',
                    }
                ],
                words:[],
                images:[],
                arraySolution: [],
                draggedWord: false,
                isWordDropped: false,
            }
        },
        template: `
            <div class="container text-center">
                <div class="row content-words">
                    <div class="col-6 content-word">
                        <div v-for="(word, index) in words" :key="index" class="word"
                            draggable="true"
                            @dragstart="dragStartWord($event, word)"
                            @dragend="dragEndWord($event)"
                        >
                            {{word}} - {{index}}
                        </div>
                    </div>
                </div>
            </div>

            <div class="container text-center">
                <div class="row content-images">
                    <div v-for="(image, index) in arraySolution" :key="index" class="col-3">
                        <div class="content-image">
                            <img 
                                class="img-fluid same-size" 
                                :src="image.url"
                            />
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div  v-for="(word, index) in dataImages" class=" col-3 drop-zone-words"
                        @drop="dropWord($event)"
                        @dragover="allowDropWord($event)"
                        :data-index="index"
                        >
                            <div v-if="arraySolution[index].word !== ''" class="word" > 
                                {{arraySolution[index].word}}
                            </div>
                    </div>
                </div>
                {{arraySolution}}
            </div>
        `,
        created(){
            this.getWords();
            this.createZoneDropArray();
        },
        methods: {
            getWords(){
                this.words = this.dataImages.map( data => data.word);
            },
            createZoneDropArray(){
                this.dataImages.forEach( element => {
                    this.arraySolution.push({
                        url: element.url,
                        word: ''
                    })
                })
            },
            dragStartWord(event, word){
                console.log('EVENT DRAG start');
                event.dataTransfer.setData('text/plain', word.toString());
            },
            dragEndWord(event){
                console.log('EVENT DRAG end');
            },
            allowDropWord(event){
                console.log('EVENT allow drop word');
                event.preventDefault();
            },
            dropWord(event){
                event.preventDefault();
                const word = event.dataTransfer.getData('text/plain');
                const targetIndex = event.target.getAttribute('data-index');

                this.arraySolution[targetIndex].word = word
                console.log(word);
                console.log('targetIndex', targetIndex);
                console.log('EVENT DROP *********');
            }
            // dropWord(event, indexDrop){
            //     event.preventDefault();
            //     const indexImage = event.dataTransfer.getData('text/plain');
            //     const indexImageNum = parseInt(indexImage)

            //     if(indexImageNum === indexDrop){
            //         this.droppedImages[indexDrop] = this.imagesUrls[indexDrop]
            //     }
            // }
        },
        computed: {
        }
    }
    app.component('images', images)
    app.mount('#container1')

    app.config.errorHandler = (err) => {
        /* handle error */
        console.log('pump error', err);
    }
</script>


</html>